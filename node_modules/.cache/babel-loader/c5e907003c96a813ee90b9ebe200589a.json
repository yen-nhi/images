{"ast":null,"code":"import _slicedToArray from \"/home/nhi/react Images/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/home/nhi/react Images/src/components/Canvas.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect, useState } from 'react';\nimport catsImg from '../images/cats.jpg';\nimport BoxForm from \"./BoxForm\";\nimport classes from './Canvas.module.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Canvas = function Canvas() {\n  _s();\n\n  var canvas = useRef();\n  var box = useRef();\n  var ctx = null;\n  var currentBox = null;\n  var image = new Image();\n  image.src = catsImg;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      newDraw = _useState2[0],\n      _setNewDraw = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      formPosition = _useState4[0],\n      setFormPosition = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      boxesArr = _useState6[0],\n      setBoxesArr = _useState6[1];\n\n  fetch('https://images-4bdb1-default-rtdb.asia-southeast1.firebasedatabase.app/images.json').then(function (res) {\n    return res.json;\n  }).then(function (data) {\n    setBoxesArr(data);\n  });\n\n  var drawBox = function drawBox(box) {\n    var borderColor = 'black';\n    var borderWidth = 1;\n    var x = box.x,\n        y = box.y,\n        w = box.w,\n        h = box.h;\n    ctx.beginPath();\n    ctx.strokeStyle = borderColor;\n    ctx.lineWidth = borderWidth;\n    ctx.rect(x, y, w, h);\n    ctx.stroke();\n    ctx.font = \"16px arial\";\n    ctx.strokeText('hello', x, y - 5);\n  };\n\n  var drawBoxes = function drawBoxes() {\n    if (ctx !== null) {\n      ctx.clearRect(0, 0, canvas.current.clientWidth, canvas.current.clientHeight);\n      ctx.drawImage(image, 0, 0);\n      boxesArr.map(function (box) {\n        return drawBox(box);\n      });\n\n      if (currentBox !== null) {\n        drawBox(currentBox);\n      }\n    }\n  };\n\n  var handleMouseDown = function handleMouseDown(e) {\n    var x = parseInt(e.nativeEvent.offsetX - canvas.current.clientLeft);\n    var y = parseInt(e.nativeEvent.offsetY - canvas.current.clientTop);\n    currentBox = {\n      x: x,\n      y: y,\n      w: 30,\n      h: 30\n    };\n    drawBoxes();\n  };\n\n  var handleMouseUp = function handleMouseUp(e) {\n    if (currentBox !== null) {\n      console.log('Done!');\n\n      _setNewDraw(true);\n\n      currentBox = null;\n    }\n\n    drawBoxes();\n  };\n\n  var handleMouseOut = function handleMouseOut(e) {\n    currentBox = null;\n    drawBoxes();\n  };\n\n  var handleMouseMove = function handleMouseMove(e) {\n    if (currentBox !== null) {\n      var _currentBox = currentBox,\n          x = _currentBox.x,\n          y = _currentBox.y,\n          w = _currentBox.w,\n          h = _currentBox.h;\n      var mouseX = parseInt(e.nativeEvent.offsetX - canvas.current.clientLeft);\n      var mouseY = parseInt(e.nativeEvent.offsetY - canvas.current.clientTop);\n      currentBox = {\n        x: x,\n        y: y,\n        w: mouseX - x,\n        h: mouseY - y\n      };\n      drawBoxes();\n    }\n  }; // initialize the canvas context\n\n\n  useEffect(function () {\n    // dynamically assign the width and height to canvas\n    var canvasEle = canvas.current;\n    canvasEle.width = canvasEle.clientWidth;\n    canvasEle.height = canvasEle.clientHeight; // get context of the canvas\n\n    ctx = canvasEle.getContext(\"2d\");\n  }, []);\n  useEffect(function () {\n    drawBoxes();\n    console.log(boxesArr);\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.page,\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      onMouseDown: handleMouseDown,\n      onMouseUp: handleMouseUp,\n      onMouseOut: handleMouseOut,\n      onMouseMove: handleMouseMove,\n      ref: canvas\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, _this), newDraw && /*#__PURE__*/_jsxDEV(BoxForm, {\n      setNewDraw: function setNewDraw() {\n        return _setNewDraw(false);\n      },\n      x: formPosition\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 21\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 7\n  }, _this);\n};\n\n_s(Canvas, \"DvewF2mZz5ig0Ny6f9Wq6KPv6EA=\");\n\n_c = Canvas;\nexport default Canvas;\n\nvar _c;\n\n$RefreshReg$(_c, \"Canvas\");","map":{"version":3,"sources":["/home/nhi/react Images/src/components/Canvas.js"],"names":["React","useRef","useEffect","useState","catsImg","BoxForm","classes","Canvas","canvas","box","ctx","currentBox","image","Image","src","newDraw","setNewDraw","formPosition","setFormPosition","boxesArr","setBoxesArr","fetch","then","res","json","data","drawBox","borderColor","borderWidth","x","y","w","h","beginPath","strokeStyle","lineWidth","rect","stroke","font","strokeText","drawBoxes","clearRect","current","clientWidth","clientHeight","drawImage","map","handleMouseDown","e","parseInt","nativeEvent","offsetX","clientLeft","offsetY","clientTop","handleMouseUp","console","log","handleMouseOut","handleMouseMove","mouseX","mouseY","canvasEle","width","height","getContext","page"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport catsImg from '../images/cats.jpg';\nimport BoxForm from \"./BoxForm\";\nimport classes from './Canvas.module.css';\n\n\nconst Canvas = () => {\n    const canvas = useRef();\n    const box = useRef();\n    let ctx = null;\n    let currentBox =  null; \n    let image = new Image();\n    image.src = catsImg;\n  \n    const [newDraw, setNewDraw] = useState(false);\n    const [formPosition, setFormPosition] = useState(0);\n    const [boxesArr, setBoxesArr] = useState([]);\n\n    fetch('https://images-4bdb1-default-rtdb.asia-southeast1.firebasedatabase.app/images.json')\n    .then(res => res.json)\n    .then(data => {\n      setBoxesArr(data)\n    });\n\n    const drawBox = (box) => {\n      const borderColor = 'black';\n      const borderWidth = 1;\n      const { x, y, w, h } = box;\n      ctx.beginPath();\n      ctx.strokeStyle = borderColor;\n      ctx.lineWidth = borderWidth;\n      ctx.rect(x, y, w, h);\n      ctx.stroke();\n      ctx.font = \"16px arial\";\n      ctx.strokeText('hello', x, y - 5);\n    }\n    const drawBoxes = () => {\n      if (ctx !== null) {\n        ctx.clearRect(0, 0, canvas.current.clientWidth, canvas.current.clientHeight);  \n        ctx.drawImage(image, 0, 0);\n        boxesArr.map(box => drawBox(box));\n        if (currentBox !== null) {\n          drawBox(currentBox);\n        }     \n      }\n    }\n  \n    const handleMouseDown = e => {\n      const x = parseInt(e.nativeEvent.offsetX - canvas.current.clientLeft);\n      const y = parseInt(e.nativeEvent.offsetY - canvas.current.clientTop);\n      currentBox = {x, y, w: 30, h: 30};\n      drawBoxes();\n    }  \n  \n    const handleMouseUp = e => {\n      if (currentBox !== null) {\n        console.log('Done!')\n        setNewDraw(true);\n        currentBox = null;\n      }\n      drawBoxes();\n    }  \n  \n    const handleMouseOut = e => {      \n      currentBox = null;\n      drawBoxes();\n    }\n  \n    const handleMouseMove = e => {\n      if (currentBox !== null) {\n        const { x, y, w, h } = currentBox;\n  \n        const mouseX = parseInt(e.nativeEvent.offsetX - canvas.current.clientLeft);\n        const mouseY = parseInt(e.nativeEvent.offsetY - canvas.current.clientTop);\n        currentBox = {x, y, w: mouseX - x, h: mouseY - y};\n        drawBoxes();\n      }\n    }\n  \n  \n    // initialize the canvas context\n    useEffect(() => {\n      // dynamically assign the width and height to canvas\n      const canvasEle = canvas.current;\n      canvasEle.width = canvasEle.clientWidth;\n      canvasEle.height = canvasEle.clientHeight;\n   \n      // get context of the canvas\n      ctx = canvasEle.getContext(\"2d\");\n    }, []);\n  \n    useEffect(() => {   \n      drawBoxes();\n      console.log(boxesArr);\n    }, []);\n  \n    return (\n      <div className={classes.page}>\n        <canvas\n          onMouseDown={handleMouseDown} \n          onMouseUp={handleMouseUp}\n          onMouseOut={handleMouseOut}\n          onMouseMove={handleMouseMove}\n          ref={canvas}> \n        </canvas>\n        {newDraw && <BoxForm \n          setNewDraw={() => setNewDraw(false)}\n          x={formPosition}/>}\n      </div>\n    );\n  }\n  \n  export default Canvas;"]},"metadata":{},"sourceType":"module"}